<mxfile host="app.diagrams.net" agent="Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/144.0.0.0 Safari/537.36" version="29.3.8">
  <diagram id="guardia-architecture" name="Guard-IA Architecture">
    <mxGraphModel dx="3158" dy="785" grid="1" gridSize="10" guides="1" tooltips="1" connect="1" arrows="1" fold="1" page="1" pageScale="1" pageWidth="1800" pageHeight="1000" math="0" shadow="0">
      <root>
        <mxCell id="0" />
        <mxCell id="1" parent="0" />
        <mxCell id="gcp-label" parent="1" style="rounded=1;whiteSpace=wrap;html=1;verticalAlign=top;fontStyle=1;fontSize=14;fillColor=none;strokeColor=#1565C0;strokeWidth=2;dashed=1;container=0;spacingTop=5;" value="Google Cloud Platform" vertex="1">
          <mxGeometry height="605" width="720" x="160" y="5" as="geometry" />
        </mxCell>
        <mxCell id="email-sender" parent="1" style="shape=actor;whiteSpace=wrap;html=1;fillColor=#fff2cc;strokeColor=#d6b656;" value="&lt;b&gt;Email Sender&lt;/b&gt;&lt;br&gt;&lt;font style=&quot;font-size:10px&quot;&gt;External SMTP&lt;/font&gt;" vertex="1">
          <mxGeometry height="70" width="80" x="20" y="50" as="geometry" />
        </mxCell>
        <mxCell id="analyst" parent="1" style="shape=actor;whiteSpace=wrap;html=1;fillColor=#fff2cc;strokeColor=#d6b656;" value="&lt;b&gt;Security&lt;br&gt;Analyst&lt;/b&gt;&lt;br&gt;&lt;font style=&quot;font-size:10px&quot;&gt;Dashboard&lt;/font&gt;" vertex="1">
          <mxGeometry height="70" width="80" x="5" y="650" as="geometry" />
        </mxCell>
        <mxCell id="vm-group" parent="1" style="rounded=1;whiteSpace=wrap;html=1;verticalAlign=top;fontStyle=1;fontSize=12;fillColor=#BBDEFB;strokeColor=#1976D2;container=1;collapsible=0;spacingTop=5;" value="GCE VM (e2-small) &amp;mdash; 34.138.132.198" vertex="1">
          <mxGeometry height="340" width="680" x="180" y="40" as="geometry" />
        </mxCell>
        <mxCell id="smtp-gateway" parent="vm-group" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#4FC3F7;strokeColor=#0277BD;fontColor=#000000;" value="&lt;b&gt;SMTP Gateway&lt;/b&gt;&lt;br&gt;&lt;font style=&quot;font-size:10px&quot;&gt;aiosmtpd :25&lt;/font&gt;" vertex="1">
          <mxGeometry height="50" width="130" x="20" y="20" as="geometry" />
        </mxCell>
        <mxCell id="email-parser" parent="vm-group" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#4FC3F7;strokeColor=#0277BD;fontColor=#000000;" value="&lt;b&gt;Email Parser&lt;/b&gt;&lt;br&gt;&lt;font style=&quot;font-size:10px&quot;&gt;RFC 5322&lt;/font&gt;" vertex="1">
          <mxGeometry height="50" width="130" x="20" y="110" as="geometry" />
        </mxCell>
        <mxCell id="pipeline-group" parent="vm-group" style="rounded=1;whiteSpace=wrap;html=1;verticalAlign=top;fontStyle=1;fontSize=11;fillColor=#E1F5FE;strokeColor=#0288D1;container=1;collapsible=0;dashed=1;" value="Detection Pipeline" vertex="1">
          <mxGeometry height="130" width="480" x="190" y="90" as="geometry" />
        </mxCell>
        <mxCell id="orchestrator" parent="pipeline-group" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#29B6F6;strokeColor=#0277BD;fontColor=#000000;" value="&lt;b&gt;Orchestrator&lt;/b&gt;" vertex="1">
          <mxGeometry height="35" width="100" x="172.5" y="90" as="geometry" />
        </mxCell>
        <mxCell id="ml-classifier" parent="pipeline-group" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#A5D6A7;strokeColor=#388E3C;fontColor=#000000;" value="&lt;b&gt;ML Classifier&lt;/b&gt;&lt;br&gt;&lt;font style=&quot;font-size:10px&quot;&gt;DistilBERT 50% ~18ms&lt;/font&gt;" vertex="1">
          <mxGeometry height="40" width="145" x="150" y="20" as="geometry" />
        </mxCell>
        <mxCell id="llm-explainer" parent="pipeline-group" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#A5D6A7;strokeColor=#388E3C;fontColor=#000000;" value="&lt;b&gt;LLM Analyst&lt;/b&gt;&lt;br&gt;&lt;font style=&quot;font-size:10px&quot;&gt;GPT-4o-mini 20% ~3s&lt;/font&gt;" vertex="1">
          <mxGeometry height="40" width="155" x="310" y="20" as="geometry" />
        </mxCell>
        <mxCell id="orch-ml" edge="1" parent="pipeline-group" source="orchestrator" style="edgeStyle=orthogonalEdgeStyle;rounded=0;" target="ml-classifier" value="">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="orch-llm" edge="1" parent="pipeline-group" source="orchestrator" style="edgeStyle=orthogonalEdgeStyle;rounded=0;" target="llm-explainer" value="">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="relay-client" parent="vm-group" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#EF9A9A;strokeColor=#C62828;fontColor=#000000;" value="&lt;b&gt;Relay Client&lt;/b&gt;&lt;br&gt;&lt;font style=&quot;font-size:10px&quot;&gt;Gmail API / SMTP fallback&lt;/font&gt;" vertex="1">
          <mxGeometry height="45" width="160" x="500" y="270" as="geometry" />
        </mxCell>
        <mxCell id="quarantine-store" parent="vm-group" style="shape=cylinder3;whiteSpace=wrap;html=1;boundedLbl=1;backgroundOutline=1;size=8;fillColor=#FFE0B2;strokeColor=#E65100;" value="&lt;b&gt;Quarantine Store&lt;/b&gt;&lt;br&gt;&lt;font style=&quot;font-size:10px&quot;&gt;.eml files&lt;/font&gt;" vertex="1">
          <mxGeometry height="50" width="130" x="275" y="270" as="geometry" />
        </mxCell>
        <mxCell id="internal-api" parent="vm-group" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#4FC3F7;strokeColor=#0277BD;fontColor=#000000;" value="&lt;b&gt;Internal API&lt;/b&gt;&lt;br&gt;&lt;font style=&quot;font-size:10px&quot;&gt;HTTP :8025&lt;/font&gt;" vertex="1">
          <mxGeometry height="45" width="130" x="110" y="270" as="geometry" />
        </mxCell>
        <mxCell id="smtp-parser" edge="1" parent="vm-group" source="smtp-gateway" style="rounded=0;" target="email-parser" value="">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="orch-quarantine" edge="1" parent="vm-group" source="orchestrator" style="html=1;edgeStyle=orthogonalEdgeStyle;rounded=0;dashed=1;strokeColor=#E65100;exitX=0.25;exitY=1;exitDx=0;exitDy=0;" target="quarantine-store" value="">
          <mxGeometry relative="1" x="0.0042" as="geometry">
            <mxPoint as="offset" />
            <Array as="points">
              <mxPoint x="388" y="250" />
              <mxPoint x="340" y="250" />
            </Array>
          </mxGeometry>
        </mxCell>
        <mxCell id="orch-relay" edge="1" parent="vm-group" source="orchestrator" style="html=1;edgeStyle=orthogonalEdgeStyle;rounded=0;strokeColor=#C62828;exitX=0.5;exitY=1;exitDx=0;exitDy=0;" target="relay-client" value="ALLOW / WARN">
          <mxGeometry relative="1" as="geometry">
            <Array as="points">
              <mxPoint x="412" y="240" />
              <mxPoint x="580" y="240" />
            </Array>
          </mxGeometry>
        </mxCell>
        <mxCell id="quarantine-relay" edge="1" parent="vm-group" source="quarantine-store" style="html=1;rounded=0;strokeColor=#E65100;" target="relay-client" value="release">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="intapi-quarantine" edge="1" parent="vm-group" source="internal-api" style="rounded=0;dashed=1;strokeColor=#E65100;" target="quarantine-store" value="">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="sD6tEUQdLG-tNoVEd2oJ-7" edge="1" parent="vm-group" source="email-parser" style="edgeStyle=orthogonalEdgeStyle;rounded=0;" target="heuristics" value="">
          <mxGeometry relative="1" as="geometry">
            <mxPoint x="330" y="175" as="sourcePoint" />
            <mxPoint x="520" y="208" as="targetPoint" />
          </mxGeometry>
        </mxCell>
        <mxCell id="heuristics" parent="vm-group" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#A5D6A7;strokeColor=#388E3C;fontColor=#000000;" value="&lt;b&gt;Heuristics&lt;/b&gt;&lt;br&gt;&lt;font style=&quot;font-size:10px&quot;&gt;30% ~5ms&lt;/font&gt;" vertex="1">
          <mxGeometry height="40" width="120" x="200" y="110" as="geometry" />
        </mxCell>
        <mxCell id="orch-heur" edge="1" parent="vm-group" source="orchestrator" style="rounded=0;" target="heuristics" value="">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="cloudrun-group" parent="1" style="rounded=1;whiteSpace=wrap;html=1;verticalAlign=top;fontStyle=1;fontSize=12;fillColor=#BBDEFB;strokeColor=#1976D2;container=1;collapsible=0;spacingTop=5;" value="Cloud Run (us-east1) &amp;mdash; 2 vCPU / 4 GiB" vertex="1">
          <mxGeometry height="155" width="510" x="180" y="430" as="geometry" />
        </mxCell>
        <mxCell id="fastapi" parent="cloudrun-group" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#42A5F5;strokeColor=#1565C0;fontColor=#FFFFFF;" value="&lt;b&gt;FastAPI Backend&lt;/b&gt;&lt;br&gt;&lt;font style=&quot;font-size:10px&quot;&gt;REST API /api/v1 :8000&lt;/font&gt;" vertex="1">
          <mxGeometry height="50" width="170" x="15" y="38" as="geometry" />
        </mxCell>
        <mxCell id="api-dashboard" parent="cloudrun-group" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#E3F2FD;strokeColor=#1976D2;fontSize=10;" value="Dashboard" vertex="1">
          <mxGeometry height="26" width="70" x="215" y="33" as="geometry" />
        </mxCell>
        <mxCell id="api-cases" parent="cloudrun-group" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#E3F2FD;strokeColor=#1976D2;fontSize=10;" value="Cases" vertex="1">
          <mxGeometry height="26" width="70" x="295" y="33" as="geometry" />
        </mxCell>
        <mxCell id="api-quarantine" parent="cloudrun-group" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#E3F2FD;strokeColor=#1976D2;fontSize=10;" value="Quarantine" vertex="1">
          <mxGeometry height="26" width="70" x="375" y="33" as="geometry" />
        </mxCell>
        <mxCell id="api-emails" parent="cloudrun-group" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#E3F2FD;strokeColor=#1976D2;fontSize=10;" value="Emails" vertex="1">
          <mxGeometry height="26" width="70" x="215" y="66" as="geometry" />
        </mxCell>
        <mxCell id="api-monitoring" parent="cloudrun-group" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#E3F2FD;strokeColor=#1976D2;fontSize=10;" value="Monitoring" vertex="1">
          <mxGeometry height="26" width="70" x="295" y="66" as="geometry" />
        </mxCell>
        <mxCell id="api-health" parent="cloudrun-group" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#E3F2FD;strokeColor=#1976D2;fontSize=10;" value="Health" vertex="1">
          <mxGeometry height="26" width="70" x="375" y="66" as="geometry" />
        </mxCell>
        <mxCell id="alembic" parent="cloudrun-group" style="text;html=1;align=left;verticalAlign=middle;resizable=0;points=[];autosize=1;fontSize=10;" value="SQLAlchemy async + Alembic migrations" vertex="1">
          <mxGeometry height="30" width="210" x="15" y="105" as="geometry" />
        </mxCell>
        <mxCell id="vercel-group" parent="1" style="rounded=1;whiteSpace=wrap;html=1;verticalAlign=top;fontStyle=1;fontSize=13;fillColor=#212121;strokeColor=#424242;fontColor=#FFFFFF;container=1;collapsible=0;spacingTop=5;" value="Vercel" vertex="1">
          <mxGeometry height="90" width="250" x="155" y="630" as="geometry" />
        </mxCell>
        <mxCell id="vue-spa" parent="vercel-group" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#424242;strokeColor=#616161;fontColor=#FFFFFF;" value="&lt;b&gt;Vue 3 SPA&lt;/b&gt;&lt;br&gt;&lt;font style=&quot;font-size:10px&quot;&gt;TypeScript + Vite + Pinia + Chart.js&lt;/font&gt;" vertex="1">
          <mxGeometry height="45" width="210" x="20" y="33" as="geometry" />
        </mxCell>
        <mxCell id="gmail-api" parent="1" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#EF5350;strokeColor=#C62828;fontColor=#FFFFFF;" value="&lt;b&gt;Gmail API&lt;/b&gt;&lt;br&gt;&lt;font style=&quot;font-size:10px&quot;&gt;users.messages.import&lt;/font&gt;" vertex="1">
          <mxGeometry height="50" width="160" x="960" y="310" as="geometry" />
        </mxCell>
        <mxCell id="google-ws" parent="1" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#FFCDD2;strokeColor=#C62828;fontColor=#000000;" value="&lt;b&gt;Google Workspace&lt;/b&gt;&lt;br&gt;&lt;font style=&quot;font-size:10px&quot;&gt;Gmail Inbox (guardia-sec.com)&lt;/font&gt;" vertex="1">
          <mxGeometry height="50" width="180" x="1200" y="310" as="geometry" />
        </mxCell>
        <mxCell id="neon" parent="1" style="shape=cylinder3;whiteSpace=wrap;html=1;boundedLbl=1;backgroundOutline=1;size=8;fillColor=#00E676;strokeColor=#00C853;fontColor=#000000;" value="&lt;b&gt;Neon&lt;/b&gt;&lt;br&gt;&lt;font style=&quot;font-size:10px&quot;&gt;PostgreSQL 16 Serverless&lt;/font&gt;" vertex="1">
          <mxGeometry height="55" width="160" x="960" y="30" as="geometry" />
        </mxCell>
        <mxCell id="hf-hub" parent="1" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#FFD600;strokeColor=#F9A825;fontColor=#000000;" value="&lt;b&gt;HuggingFace Hub&lt;/b&gt;&lt;br&gt;&lt;font style=&quot;font-size:10px&quot;&gt;distilbert-guardia-v2&lt;/font&gt;" vertex="1">
          <mxGeometry height="50" width="180" x="1180" y="133" as="geometry" />
        </mxCell>
        <mxCell id="openai" parent="1" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#00BFA5;strokeColor=#00897B;fontColor=#FFFFFF;" value="&lt;b&gt;OpenAI API&lt;/b&gt;&lt;br&gt;&lt;font style=&quot;font-size:10px&quot;&gt;GPT-4o-mini&lt;/font&gt;" vertex="1">
          <mxGeometry height="50" width="160" x="960" y="215" as="geometry" />
        </mxCell>
        <mxCell id="slack" parent="1" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#7B1FA2;strokeColor=#4A148C;fontColor=#FFFFFF;" value="&lt;b&gt;Slack&lt;/b&gt;&lt;br&gt;&lt;font style=&quot;font-size:10px&quot;&gt;Webhook Alerts&lt;/font&gt;" vertex="1">
          <mxGeometry height="50" width="180" x="1180" y="215" as="geometry" />
        </mxCell>
        <mxCell id="clerk" parent="1" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#7C4DFF;strokeColor=#651FFF;fontColor=#FFFFFF;" value="&lt;b&gt;Clerk&lt;/b&gt;&lt;br&gt;&lt;font style=&quot;font-size:10px&quot;&gt;Auth RS256 JWT&lt;/font&gt;" vertex="1">
          <mxGeometry height="50" width="160" x="570" y="640" as="geometry" />
        </mxCell>
        <mxCell id="cicd-group" parent="1" style="rounded=1;whiteSpace=wrap;html=1;verticalAlign=top;fontStyle=1;fontSize=12;fillColor=#ECEFF1;strokeColor=#607D8B;container=1;collapsible=0;spacingTop=5;dashed=1;" value="CI/CD" vertex="1">
          <mxGeometry height="170" width="410" x="890" y="800" as="geometry" />
        </mxCell>
        <mxCell id="gh-actions" parent="cicd-group" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#B0BEC5;strokeColor=#607D8B;fontColor=#000000;" value="&lt;b&gt;GitHub Actions&lt;/b&gt;&lt;br&gt;&lt;font style=&quot;font-size:10px&quot;&gt;5 workflows&lt;/font&gt;" vertex="1">
          <mxGeometry height="45" width="130" x="15" y="35" as="geometry" />
        </mxCell>
        <mxCell id="wf-ci" parent="cicd-group" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#CFD8DC;strokeColor=#90A4AE;fontSize=9;" value="ci (PR checks)" vertex="1">
          <mxGeometry height="22" width="200" x="185" y="25" as="geometry" />
        </mxCell>
        <mxCell id="wf-backend-stg" parent="cicd-group" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#CFD8DC;strokeColor=#90A4AE;fontSize=9;" value="deploy-backend-staging" vertex="1">
          <mxGeometry height="22" width="200" x="185" y="52" as="geometry" />
        </mxCell>
        <mxCell id="wf-backend-prod" parent="cicd-group" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#CFD8DC;strokeColor=#90A4AE;fontSize=9;" value="deploy-backend-production" vertex="1">
          <mxGeometry height="22" width="200" x="185" y="79" as="geometry" />
        </mxCell>
        <mxCell id="wf-frontend-stg" parent="cicd-group" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#CFD8DC;strokeColor=#90A4AE;fontSize=9;" value="deploy-frontend-staging" vertex="1">
          <mxGeometry height="22" width="200" x="185" y="106" as="geometry" />
        </mxCell>
        <mxCell id="wf-frontend-prod" parent="cicd-group" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#CFD8DC;strokeColor=#90A4AE;fontSize=9;" value="deploy-frontend-production" vertex="1">
          <mxGeometry height="22" width="200" x="185" y="133" as="geometry" />
        </mxCell>
        <mxCell id="deploy-targets" parent="cicd-group" style="text;html=1;align=left;verticalAlign=middle;resizable=0;points=[];autosize=1;fontSize=9;" value="Backend: Cloud Run + VM sync&lt;br&gt;Frontend: Vite build + Vercel CLI" vertex="1">
          <mxGeometry height="40" width="150" x="15" y="100" as="geometry" />
        </mxCell>
        <mxCell id="conn-sender-smtp" edge="1" parent="1" source="email-sender" style="html=1;rounded=0;exitX=1;exitY=0.5;exitDx=0;exitDy=0;fontSize=9;labelBackgroundColor=#FFFFFF;" target="smtp-gateway" value="SMTP :25">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="conn-relay-gmail" edge="1" parent="1" source="relay-client" style="html=1;rounded=0;strokeColor=#C62828;strokeWidth=2;fontSize=9;labelBackgroundColor=#FFFFFF;" target="gmail-api" value="HTTPS">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="conn-gmail-gws" edge="1" parent="1" source="gmail-api" style="html=1;rounded=0;strokeColor=#C62828;strokeWidth=2;fontSize=9;labelBackgroundColor=#FFFFFF;" target="google-ws" value="import">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="conn-llm-openai" edge="1" parent="1" source="llm-explainer" style="html=1;rounded=0;dashed=1;fontSize=9;labelBackgroundColor=#FFFFFF;" target="openai" value="">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="conn-ml-hf" edge="1" parent="1" source="ml-classifier" style="html=1;edgeStyle=orthogonalEdgeStyle;rounded=0;dashed=1;fontSize=9;labelBackgroundColor=#FFFFFF;" target="hf-hub" value="auto-download">
          <mxGeometry relative="1" as="geometry">
            <Array as="points">
              <mxPoint x="930" y="148" />
              <mxPoint x="930" y="158" />
            </Array>
          </mxGeometry>
        </mxCell>
        <mxCell id="conn-cr-internal" edge="1" parent="1" source="fastapi" style="html=1;edgeStyle=orthogonalEdgeStyle;rounded=0;strokeColor=#E65100;dashed=1;fontSize=9;labelBackgroundColor=#FFFFFF;" target="internal-api" value="release">
          <mxGeometry relative="1" as="geometry">
            <Array as="points">
              <mxPoint x="350" y="420" />
              <mxPoint x="350" y="370" />
            </Array>
          </mxGeometry>
        </mxCell>
        <mxCell id="conn-spa-api" edge="1" parent="1" source="vue-spa" style="html=1;rounded=0;fontSize=9;labelBackgroundColor=#FFFFFF;" target="fastapi" value="/api/v1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="conn-analyst-spa" edge="1" parent="1" source="analyst" style="html=1;rounded=0;fontSize=9;labelBackgroundColor=#FFFFFF;" target="vue-spa" value="HTTPS">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="legend-group" parent="1" style="rounded=1;whiteSpace=wrap;html=1;verticalAlign=top;fontStyle=1;fontSize=11;fillColor=#FAFAFA;strokeColor=#BDBDBD;container=1;collapsible=0;" value="Legend" vertex="1">
          <mxGeometry height="110" width="480" x="370" y="800" as="geometry" />
        </mxCell>
        <mxCell id="leg-solid" parent="legend-group" style="text;html=1;align=left;verticalAlign=middle;resizable=0;points=[];autosize=1;fontSize=10;" value="&amp;mdash;&amp;mdash; Solid line: primary data flow" vertex="1">
          <mxGeometry height="25" width="200" x="10" y="25" as="geometry" />
        </mxCell>
        <mxCell id="leg-dashed" parent="legend-group" style="text;html=1;align=left;verticalAlign=middle;resizable=0;points=[];autosize=1;fontSize=10;" value="- - - Dashed line: async / on-demand" vertex="1">
          <mxGeometry height="25" width="210" x="10" y="50" as="geometry" />
        </mxCell>
        <mxCell id="leg-red" parent="legend-group" style="text;html=1;align=left;verticalAlign=middle;resizable=0;points=[];autosize=1;fontSize=10;fontColor=#C62828;" value="&amp;mdash;&amp;mdash; Red line: email delivery path" vertex="1">
          <mxGeometry height="25" width="200" x="10" y="75" as="geometry" />
        </mxCell>
        <mxCell id="leg-score" parent="legend-group" style="text;html=1;align=left;verticalAlign=middle;resizable=0;points=[];autosize=1;fontSize=10;" value="&lt;b&gt;Final Score&lt;/b&gt; = 0.30xH + 0.50xML + 0.20xLLM&lt;br&gt;+ LLM floor/cap adjustments" vertex="1">
          <mxGeometry height="40" width="250" x="230" y="22" as="geometry" />
        </mxCell>
        <mxCell id="leg-verdicts" parent="legend-group" style="text;html=1;align=left;verticalAlign=middle;resizable=0;points=[];autosize=1;fontSize=10;" value="&lt;b&gt;Verdicts:&lt;/b&gt; ALLOW &amp;lt;0.3 | WARN 0.3-0.6&lt;br&gt;QUARANTINE 0.6-0.8 | BLOCK &amp;ge;0.8" vertex="1">
          <mxGeometry height="40" width="230" x="230" y="62" as="geometry" />
        </mxCell>
        <mxCell id="title" parent="1" style="text;html=1;align=right;verticalAlign=middle;resizable=0;points=[];autosize=1;" value="&lt;font style=&quot;font-size:16px&quot;&gt;&lt;b&gt;Guard-IA &amp;mdash; Infrastructure Architecture&lt;/b&gt;&lt;/font&gt;&lt;br&gt;&lt;font style=&quot;font-size:10px&quot;&gt;AI-powered pre-delivery email fraud detection middleware&lt;/font&gt;" vertex="1">
          <mxGeometry height="50" width="340" x="1050" y="640" as="geometry" />
        </mxCell>
        <mxCell id="sD6tEUQdLG-tNoVEd2oJ-4" parent="1" style="shape=cylinder3;whiteSpace=wrap;html=1;boundedLbl=1;backgroundOutline=1;size=8;fillColor=#00E676;strokeColor=#00C853;fontColor=#000000;" value="&lt;b&gt;Neon&lt;/b&gt;&lt;br&gt;&lt;font style=&quot;font-size:10px&quot;&gt;PostgreSQL 16 Serverless&lt;/font&gt;" vertex="1">
          <mxGeometry height="55" width="160" x="-40" y="310" as="geometry" />
        </mxCell>
        <mxCell id="sD6tEUQdLG-tNoVEd2oJ-5" edge="1" parent="1" source="fastapi" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;entryX=0.5;entryY=1;entryDx=0;entryDy=0;entryPerimeter=0;" target="sD6tEUQdLG-tNoVEd2oJ-4">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="sD6tEUQdLG-tNoVEd2oJ-6" edge="1" parent="1" source="orchestrator" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;entryX=0.5;entryY=0;entryDx=0;entryDy=0;entryPerimeter=0;" target="sD6tEUQdLG-tNoVEd2oJ-4">
          <mxGeometry relative="1" as="geometry">
            <Array as="points">
              <mxPoint x="430" y="237" />
              <mxPoint x="40" y="237" />
            </Array>
          </mxGeometry>
        </mxCell>
      </root>
    </mxGraphModel>
  </diagram>
</mxfile>
