<mxfile host="app.diagrams.net" modified="2025-01-01T00:00:00.000Z" agent="draw.io" version="24.0.0" type="device">
  <diagram id="guardia-architecture" name="Guard-IA Architecture">
    <mxGraphModel dx="1422" dy="762" grid="1" gridSize="10" guides="1" tooltips="1" connect="1" arrows="1" fold="1" page="1" pageScale="1" pageWidth="1600" pageHeight="1000" math="0" shadow="0">
      <root>
        <mxCell id="0" />
        <mxCell id="1" parent="0" />

        <!-- ==================== INTERNET GROUP ==================== -->
        <mxCell id="internet-group" value="Internet" style="rounded=1;whiteSpace=wrap;html=1;verticalAlign=top;fontStyle=1;fontSize=13;fillColor=#f5f5f5;strokeColor=#666666;dashed=1;container=1;collapsible=0;spacingTop=5;" vertex="1" parent="1">
          <mxGeometry x="20" y="350" width="160" height="240" as="geometry" />
        </mxCell>
        <mxCell id="email-sender" value="&lt;b&gt;Email Sender&lt;/b&gt;&lt;br&gt;&lt;font style=&quot;font-size:10px&quot;&gt;Inbound SMTP&lt;/font&gt;" style="shape=actor;whiteSpace=wrap;html=1;fillColor=#fff2cc;strokeColor=#d6b656;" vertex="1" parent="internet-group">
          <mxGeometry x="40" y="40" width="80" height="70" as="geometry" />
        </mxCell>
        <mxCell id="analyst" value="&lt;b&gt;Security&lt;br&gt;Analyst&lt;/b&gt;&lt;br&gt;&lt;font style=&quot;font-size:10px&quot;&gt;Dashboard&lt;/font&gt;" style="shape=actor;whiteSpace=wrap;html=1;fillColor=#fff2cc;strokeColor=#d6b656;" vertex="1" parent="internet-group">
          <mxGeometry x="40" y="140" width="80" height="70" as="geometry" />
        </mxCell>

        <!-- ==================== GCP GROUP ==================== -->
        <mxCell id="gcp-group" value="Google Cloud Platform" style="rounded=1;whiteSpace=wrap;html=1;verticalAlign=top;fontStyle=1;fontSize=14;fillColor=#E3F2FD;strokeColor=#1565C0;strokeWidth=2;container=1;collapsible=0;spacingTop=5;" vertex="1" parent="1">
          <mxGeometry x="240" y="60" width="620" height="580" as="geometry" />
        </mxCell>

        <!-- GCE VM Subgroup -->
        <mxCell id="vm-group" value="GCE VM (e2-small) — 34.138.132.198" style="rounded=1;whiteSpace=wrap;html=1;verticalAlign=top;fontStyle=1;fontSize=12;fillColor=#BBDEFB;strokeColor=#1976D2;container=1;collapsible=0;spacingTop=5;" vertex="1" parent="gcp-group">
          <mxGeometry x="20" y="40" width="580" height="300" as="geometry" />
        </mxCell>

        <!-- SMTP Gateway -->
        <mxCell id="smtp-gateway" value="&lt;b&gt;SMTP Gateway&lt;/b&gt;&lt;br&gt;&lt;font style=&quot;font-size:10px&quot;&gt;aiosmtpd :25&lt;/font&gt;" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#4FC3F7;strokeColor=#0277BD;fontColor=#000000;" vertex="1" parent="vm-group">
          <mxGeometry x="20" y="40" width="120" height="50" as="geometry" />
        </mxCell>
        <mxCell id="email-parser" value="&lt;b&gt;Email Parser&lt;/b&gt;&lt;br&gt;&lt;font style=&quot;font-size:10px&quot;&gt;RFC 5322&lt;/font&gt;" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#4FC3F7;strokeColor=#0277BD;fontColor=#000000;" vertex="1" parent="vm-group">
          <mxGeometry x="20" y="110" width="120" height="50" as="geometry" />
        </mxCell>

        <!-- Detection Pipeline -->
        <mxCell id="pipeline-group" value="Detection Pipeline" style="rounded=1;whiteSpace=wrap;html=1;verticalAlign=top;fontStyle=1;fontSize=11;fillColor=#E1F5FE;strokeColor=#0288D1;container=1;collapsible=0;dashed=1;" vertex="1" parent="vm-group">
          <mxGeometry x="170" y="35" width="390" height="130" as="geometry" />
        </mxCell>
        <mxCell id="orchestrator" value="&lt;b&gt;Orchestrator&lt;/b&gt;" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#29B6F6;strokeColor=#0277BD;fontColor=#000000;" vertex="1" parent="pipeline-group">
          <mxGeometry x="10" y="30" width="100" height="40" as="geometry" />
        </mxCell>
        <mxCell id="heuristics" value="&lt;b&gt;Heuristics&lt;/b&gt;&lt;br&gt;&lt;font style=&quot;font-size:10px&quot;&gt;30% ~5ms&lt;/font&gt;" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#A5D6A7;strokeColor=#388E3C;fontColor=#000000;" vertex="1" parent="pipeline-group">
          <mxGeometry x="10" y="80" width="110" height="40" as="geometry" />
        </mxCell>
        <mxCell id="ml-classifier" value="&lt;b&gt;ML Classifier&lt;/b&gt;&lt;br&gt;&lt;font style=&quot;font-size:10px&quot;&gt;DistilBERT 50% ~18ms&lt;/font&gt;" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#A5D6A7;strokeColor=#388E3C;fontColor=#000000;" vertex="1" parent="pipeline-group">
          <mxGeometry x="140" y="80" width="120" height="40" as="geometry" />
        </mxCell>
        <mxCell id="llm-explainer" value="&lt;b&gt;LLM Analyst&lt;/b&gt;&lt;br&gt;&lt;font style=&quot;font-size:10px&quot;&gt;GPT-4o-mini 20% ~2-3s&lt;/font&gt;" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#A5D6A7;strokeColor=#388E3C;fontColor=#000000;" vertex="1" parent="pipeline-group">
          <mxGeometry x="275" y="80" width="105" height="40" as="geometry" />
        </mxCell>

        <!-- Orchestrator arrows to layers -->
        <mxCell id="orch-heur" style="edgeStyle=orthogonalEdgeStyle;rounded=0;" edge="1" source="orchestrator" target="heuristics" parent="pipeline-group">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="orch-ml" style="edgeStyle=orthogonalEdgeStyle;rounded=0;" edge="1" source="orchestrator" target="ml-classifier" parent="pipeline-group">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="orch-llm" style="edgeStyle=orthogonalEdgeStyle;rounded=0;" edge="1" source="orchestrator" target="llm-explainer" parent="pipeline-group">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>

        <!-- Quarantine Store -->
        <mxCell id="quarantine-store" value="&lt;b&gt;Quarantine Store&lt;/b&gt;&lt;br&gt;&lt;font style=&quot;font-size:10px&quot;&gt;.eml files&lt;/font&gt;" style="shape=cylinder3;whiteSpace=wrap;html=1;boundedLbl=1;backgroundOutline=1;size=8;fillColor=#FFE0B2;strokeColor=#E65100;" vertex="1" parent="vm-group">
          <mxGeometry x="20" y="195" width="120" height="50" as="geometry" />
        </mxCell>

        <!-- Internal API -->
        <mxCell id="internal-api" value="&lt;b&gt;Internal API&lt;/b&gt;&lt;br&gt;&lt;font style=&quot;font-size:10px&quot;&gt;HTTP :8025&lt;/font&gt;" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#4FC3F7;strokeColor=#0277BD;fontColor=#000000;" vertex="1" parent="vm-group">
          <mxGeometry x="20" y="255" width="120" height="40" as="geometry" />
        </mxCell>

        <!-- VM internal arrows -->
        <mxCell id="smtp-parser" style="rounded=0;" edge="1" source="smtp-gateway" target="email-parser" parent="vm-group">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="parser-orch" style="rounded=0;" edge="1" source="email-parser" target="orchestrator" parent="vm-group">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>

        <!-- Cloud Run Subgroup -->
        <mxCell id="cloudrun-group" value="Cloud Run (us-east1) — 2 vCPU / 4 GiB" style="rounded=1;whiteSpace=wrap;html=1;verticalAlign=top;fontStyle=1;fontSize=12;fillColor=#BBDEFB;strokeColor=#1976D2;container=1;collapsible=0;spacingTop=5;" vertex="1" parent="gcp-group">
          <mxGeometry x="20" y="370" width="580" height="180" as="geometry" />
        </mxCell>
        <mxCell id="fastapi" value="&lt;b&gt;FastAPI Backend&lt;/b&gt;&lt;br&gt;&lt;font style=&quot;font-size:10px&quot;&gt;REST API /api/v1 :8000&lt;/font&gt;" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#42A5F5;strokeColor=#1565C0;fontColor=#FFFFFF;" vertex="1" parent="cloudrun-group">
          <mxGeometry x="20" y="40" width="180" height="50" as="geometry" />
        </mxCell>
        <mxCell id="api-cases" value="Cases" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#E3F2FD;strokeColor=#1976D2;fontSize=10;" vertex="1" parent="cloudrun-group">
          <mxGeometry x="230" y="35" width="70" height="30" as="geometry" />
        </mxCell>
        <mxCell id="api-dashboard" value="Dashboard" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#E3F2FD;strokeColor=#1976D2;fontSize=10;" vertex="1" parent="cloudrun-group">
          <mxGeometry x="310" y="35" width="70" height="30" as="geometry" />
        </mxCell>
        <mxCell id="api-quarantine" value="Quarantine" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#E3F2FD;strokeColor=#1976D2;fontSize=10;" vertex="1" parent="cloudrun-group">
          <mxGeometry x="390" y="35" width="70" height="30" as="geometry" />
        </mxCell>
        <mxCell id="api-monitoring" value="Monitoring" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#E3F2FD;strokeColor=#1976D2;fontSize=10;" vertex="1" parent="cloudrun-group">
          <mxGeometry x="470" y="35" width="70" height="30" as="geometry" />
        </mxCell>
        <mxCell id="api-emails" value="Emails" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#E3F2FD;strokeColor=#1976D2;fontSize=10;" vertex="1" parent="cloudrun-group">
          <mxGeometry x="230" y="70" width="70" height="30" as="geometry" />
        </mxCell>
        <mxCell id="api-ingestion" value="Ingestion" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#E3F2FD;strokeColor=#1976D2;fontSize=10;" vertex="1" parent="cloudrun-group">
          <mxGeometry x="310" y="70" width="70" height="30" as="geometry" />
        </mxCell>
        <mxCell id="api-health" value="Health" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#E3F2FD;strokeColor=#1976D2;fontSize=10;" vertex="1" parent="cloudrun-group">
          <mxGeometry x="390" y="70" width="70" height="30" as="geometry" />
        </mxCell>

        <!-- Alembic migrations note -->
        <mxCell id="alembic" value="&lt;font style=&quot;font-size:10px&quot;&gt;SQLAlchemy async + Alembic migrations&lt;/font&gt;" style="text;html=1;align=center;verticalAlign=middle;resizable=0;points=[];autosize=1;" vertex="1" parent="cloudrun-group">
          <mxGeometry x="20" y="120" width="210" height="30" as="geometry" />
        </mxCell>

        <!-- ==================== VERCEL ==================== -->
        <mxCell id="vercel-group" value="Vercel" style="rounded=1;whiteSpace=wrap;html=1;verticalAlign=top;fontStyle=1;fontSize=13;fillColor=#212121;strokeColor=#424242;fontColor=#FFFFFF;container=1;collapsible=0;spacingTop=5;" vertex="1" parent="1">
          <mxGeometry x="920" y="370" width="200" height="120" as="geometry" />
        </mxCell>
        <mxCell id="vue-spa" value="&lt;font color=&quot;#ffffff&quot;&gt;&lt;b&gt;Vue 3 SPA&lt;/b&gt;&lt;br&gt;&lt;font style=&quot;font-size:10px&quot;&gt;TypeScript + Vite + Pinia&lt;br&gt;Chart.js + Material Symbols&lt;/font&gt;&lt;/font&gt;" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#424242;strokeColor=#616161;fontColor=#FFFFFF;" vertex="1" parent="vercel-group">
          <mxGeometry x="20" y="35" width="160" height="65" as="geometry" />
        </mxCell>

        <!-- ==================== GOOGLE WORKSPACE ==================== -->
        <mxCell id="google-ws" value="&lt;b&gt;Google Workspace&lt;/b&gt;&lt;br&gt;&lt;font style=&quot;font-size:10px&quot;&gt;Gmail Inbox&lt;br&gt;(strike.sh)&lt;/font&gt;" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#FFCDD2;strokeColor=#C62828;fontColor=#000000;" vertex="1" parent="1">
          <mxGeometry x="920" y="160" width="200" height="60" as="geometry" />
        </mxCell>

        <!-- ==================== EXTERNAL SERVICES ==================== -->
        <mxCell id="ext-group" value="External Services" style="rounded=1;whiteSpace=wrap;html=1;verticalAlign=top;fontStyle=1;fontSize=13;fillColor=#F3E5F5;strokeColor=#7B1FA2;container=1;collapsible=0;spacingTop=5;dashed=1;" vertex="1" parent="1">
          <mxGeometry x="1170" y="60" width="400" height="520" as="geometry" />
        </mxCell>

        <!-- Neon PostgreSQL -->
        <mxCell id="neon" value="&lt;b&gt;Neon&lt;/b&gt;&lt;br&gt;&lt;font style=&quot;font-size:10px&quot;&gt;PostgreSQL 16&lt;br&gt;Serverless&lt;/font&gt;" style="shape=cylinder3;whiteSpace=wrap;html=1;boundedLbl=1;backgroundOutline=1;size=8;fillColor=#00E676;strokeColor=#00C853;fontColor=#000000;" vertex="1" parent="ext-group">
          <mxGeometry x="20" y="40" width="130" height="70" as="geometry" />
        </mxCell>

        <!-- Clerk Auth -->
        <mxCell id="clerk" value="&lt;b&gt;Clerk&lt;/b&gt;&lt;br&gt;&lt;font style=&quot;font-size:10px&quot;&gt;Auth (RS256 JWT)&lt;br&gt;Invitation-only&lt;/font&gt;" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#7C4DFF;strokeColor=#651FFF;fontColor=#FFFFFF;" vertex="1" parent="ext-group">
          <mxGeometry x="20" y="140" width="130" height="60" as="geometry" />
        </mxCell>

        <!-- OpenAI -->
        <mxCell id="openai" value="&lt;b&gt;OpenAI API&lt;/b&gt;&lt;br&gt;&lt;font style=&quot;font-size:10px&quot;&gt;GPT-4o-mini&lt;br&gt;LLM Analyst&lt;/font&gt;" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#00BFA5;strokeColor=#00897B;fontColor=#FFFFFF;" vertex="1" parent="ext-group">
          <mxGeometry x="20" y="230" width="130" height="60" as="geometry" />
        </mxCell>

        <!-- Gmail API -->
        <mxCell id="gmail-api" value="&lt;b&gt;Gmail API&lt;/b&gt;&lt;br&gt;&lt;font style=&quot;font-size:10px&quot;&gt;users.messages.import&lt;br&gt;Primary delivery&lt;/font&gt;" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#EF5350;strokeColor=#C62828;fontColor=#FFFFFF;" vertex="1" parent="ext-group">
          <mxGeometry x="200" y="40" width="150" height="60" as="geometry" />
        </mxCell>

        <!-- HuggingFace Hub -->
        <mxCell id="hf-hub" value="&lt;b&gt;HuggingFace Hub&lt;/b&gt;&lt;br&gt;&lt;font style=&quot;font-size:10px&quot;&gt;distilbert-guardia-v2&lt;br&gt;Auto-download&lt;/font&gt;" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#FFD600;strokeColor=#F9A825;fontColor=#000000;" vertex="1" parent="ext-group">
          <mxGeometry x="200" y="140" width="150" height="60" as="geometry" />
        </mxCell>

        <!-- Slack -->
        <mxCell id="slack" value="&lt;b&gt;Slack&lt;/b&gt;&lt;br&gt;&lt;font style=&quot;font-size:10px&quot;&gt;Webhook Alerts&lt;br&gt;High-risk notifications&lt;/font&gt;" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#7B1FA2;strokeColor=#4A148C;fontColor=#FFFFFF;" vertex="1" parent="ext-group">
          <mxGeometry x="200" y="230" width="150" height="60" as="geometry" />
        </mxCell>

        <!-- ==================== CI/CD ==================== -->
        <mxCell id="cicd-group" value="CI/CD" style="rounded=1;whiteSpace=wrap;html=1;verticalAlign=top;fontStyle=1;fontSize=13;fillColor=#ECEFF1;strokeColor=#607D8B;container=1;collapsible=0;spacingTop=5;dashed=1;" vertex="1" parent="1">
          <mxGeometry x="1170" y="400" width="400" height="180" as="geometry" />
        </mxCell>
        <mxCell id="gh-actions" value="&lt;b&gt;GitHub Actions&lt;/b&gt;&lt;br&gt;&lt;font style=&quot;font-size:10px&quot;&gt;4 workflows&lt;/font&gt;" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#B0BEC5;strokeColor=#607D8B;fontColor=#000000;" vertex="1" parent="cicd-group">
          <mxGeometry x="20" y="35" width="140" height="45" as="geometry" />
        </mxCell>
        <mxCell id="wf-backend-stg" value="deploy-backend-staging" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#CFD8DC;strokeColor=#90A4AE;fontSize=9;" vertex="1" parent="cicd-group">
          <mxGeometry x="190" y="30" width="180" height="25" as="geometry" />
        </mxCell>
        <mxCell id="wf-backend-prod" value="deploy-backend-production" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#CFD8DC;strokeColor=#90A4AE;fontSize=9;" vertex="1" parent="cicd-group">
          <mxGeometry x="190" y="60" width="180" height="25" as="geometry" />
        </mxCell>
        <mxCell id="wf-frontend-stg" value="deploy-frontend-staging" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#CFD8DC;strokeColor=#90A4AE;fontSize=9;" vertex="1" parent="cicd-group">
          <mxGeometry x="190" y="90" width="180" height="25" as="geometry" />
        </mxCell>
        <mxCell id="wf-frontend-prod" value="deploy-frontend-production" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#CFD8DC;strokeColor=#90A4AE;fontSize=9;" vertex="1" parent="cicd-group">
          <mxGeometry x="190" y="120" width="180" height="25" as="geometry" />
        </mxCell>
        <!-- Deploy targets text -->
        <mxCell id="deploy-targets" value="&lt;font style=&quot;font-size:9px&quot;&gt;Backend → Cloud Run + VM sync&lt;br&gt;Frontend → Vite build + Vercel CLI&lt;/font&gt;" style="text;html=1;align=left;verticalAlign=middle;resizable=0;points=[];autosize=1;" vertex="1" parent="cicd-group">
          <mxGeometry x="20" y="100" width="160" height="40" as="geometry" />
        </mxCell>

        <!-- ==================== CONNECTIONS ==================== -->

        <!-- Email Sender → SMTP Gateway -->
        <mxCell id="conn-sender-smtp" value="SMTP :25" style="rounded=0;fontStyle=0;fontSize=10;exitX=1;exitY=0.5;exitDx=0;exitDy=0;" edge="1" source="email-sender" target="smtp-gateway" parent="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>

        <!-- Analyst → Vue SPA -->
        <mxCell id="conn-analyst-spa" value="HTTPS" style="rounded=0;fontStyle=0;fontSize=10;exitX=1;exitY=0.5;exitDx=0;exitDy=0;" edge="1" source="analyst" target="vue-spa" parent="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>

        <!-- Vue SPA → FastAPI -->
        <mxCell id="conn-spa-api" value="/api/v1" style="rounded=0;fontStyle=0;fontSize=10;" edge="1" source="vue-spa" target="fastapi" parent="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>

        <!-- FastAPI → Neon -->
        <mxCell id="conn-api-neon" value="asyncpg" style="rounded=0;fontStyle=0;fontSize=10;" edge="1" source="fastapi" target="neon" parent="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>

        <!-- Pipeline → Neon (persist) -->
        <mxCell id="conn-pipeline-neon" value="persist" style="rounded=0;fontStyle=0;fontSize=10;dashed=1;" edge="1" source="orchestrator" target="neon" parent="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>

        <!-- Pipeline → OpenAI (LLM) -->
        <mxCell id="conn-pipeline-openai" value="" style="rounded=0;fontStyle=0;fontSize=10;dashed=1;" edge="1" source="llm-explainer" target="openai" parent="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>

        <!-- ML → HF Hub -->
        <mxCell id="conn-ml-hf" value="auto-download" style="rounded=0;fontStyle=0;fontSize=10;dashed=1;" edge="1" source="ml-classifier" target="hf-hub" parent="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>

        <!-- Pipeline → Gmail API (deliver) -->
        <mxCell id="conn-pipeline-gmail" value="deliver" style="rounded=0;fontStyle=0;fontSize=10;strokeColor=#C62828;" edge="1" source="orchestrator" target="gmail-api" parent="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>

        <!-- Gmail API → Google Workspace -->
        <mxCell id="conn-gmail-gws" value="import" style="rounded=0;fontStyle=0;fontSize=10;strokeColor=#C62828;" edge="1" source="gmail-api" target="google-ws" parent="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>

        <!-- Pipeline → Slack (alerts) -->
        <mxCell id="conn-pipeline-slack" value="alert" style="rounded=0;fontStyle=0;fontSize=10;dashed=1;" edge="1" source="orchestrator" target="slack" parent="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>

        <!-- Cloud Run → Internal API (quarantine release) -->
        <mxCell id="conn-cr-internal" value="quarantine&lt;br&gt;release" style="rounded=0;fontStyle=0;fontSize=10;strokeColor=#E65100;" edge="1" source="fastapi" target="internal-api" parent="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>

        <!-- Vue SPA ↔ Clerk -->
        <mxCell id="conn-spa-clerk" value="JWT" style="rounded=0;fontStyle=0;fontSize=10;dashed=1;strokeColor=#7C4DFF;" edge="1" source="vue-spa" target="clerk" parent="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>

        <!-- FastAPI ↔ Clerk -->
        <mxCell id="conn-api-clerk" value="verify" style="rounded=0;fontStyle=0;fontSize=10;dashed=1;strokeColor=#7C4DFF;" edge="1" source="fastapi" target="clerk" parent="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>

        <!-- ==================== LEGEND ==================== -->
        <mxCell id="legend-group" value="Legend" style="rounded=1;whiteSpace=wrap;html=1;verticalAlign=top;fontStyle=1;fontSize=11;fillColor=#FAFAFA;strokeColor=#BDBDBD;container=1;collapsible=0;" vertex="1" parent="1">
          <mxGeometry x="20" y="680" width="510" height="110" as="geometry" />
        </mxCell>
        <mxCell id="leg-solid" value="&lt;font style=&quot;font-size:10px&quot;&gt;── Solid line: primary data flow&lt;/font&gt;" style="text;html=1;align=left;verticalAlign=middle;resizable=0;points=[];autosize=1;" vertex="1" parent="legend-group">
          <mxGeometry x="10" y="25" width="170" height="30" as="geometry" />
        </mxCell>
        <mxCell id="leg-dashed" value="&lt;font style=&quot;font-size:10px&quot;&gt;- - Dashed line: async / on-demand&lt;/font&gt;" style="text;html=1;align=left;verticalAlign=middle;resizable=0;points=[];autosize=1;" vertex="1" parent="legend-group">
          <mxGeometry x="10" y="50" width="190" height="30" as="geometry" />
        </mxCell>
        <mxCell id="leg-red" value="&lt;font style=&quot;font-size:10px&quot;&gt;── Red line: email delivery path&lt;/font&gt;" style="text;html=1;align=left;verticalAlign=middle;resizable=0;points=[];autosize=1;fontColor=#C62828;" vertex="1" parent="legend-group">
          <mxGeometry x="10" y="75" width="170" height="30" as="geometry" />
        </mxCell>
        <mxCell id="leg-score" value="&lt;font style=&quot;font-size:10px&quot;&gt;&lt;b&gt;Final Score&lt;/b&gt; = 0.30×H + 0.50×ML + 0.20×LLM&lt;br&gt;+ LLM floor/cap adjustments&lt;/font&gt;" style="text;html=1;align=left;verticalAlign=middle;resizable=0;points=[];autosize=1;" vertex="1" parent="legend-group">
          <mxGeometry x="220" y="25" width="240" height="40" as="geometry" />
        </mxCell>
        <mxCell id="leg-verdicts" value="&lt;font style=&quot;font-size:10px&quot;&gt;&lt;b&gt;Verdicts:&lt;/b&gt; ALLOW &amp;lt;0.3 | WARN 0.3-0.6&lt;br&gt;QUARANTINE 0.6-0.8 | BLOCK ≥0.8&lt;/font&gt;" style="text;html=1;align=left;verticalAlign=middle;resizable=0;points=[];autosize=1;" vertex="1" parent="legend-group">
          <mxGeometry x="220" y="65" width="220" height="40" as="geometry" />
        </mxCell>

        <!-- Title -->
        <mxCell id="title" value="&lt;font style=&quot;font-size:18px&quot;&gt;&lt;b&gt;Guard-IA — Infrastructure Architecture&lt;/b&gt;&lt;/font&gt;&lt;br&gt;&lt;font style=&quot;font-size:11px&quot;&gt;AI-powered pre-delivery email fraud detection middleware&lt;/font&gt;" style="text;html=1;align=center;verticalAlign=middle;resizable=0;points=[];autosize=1;" vertex="1" parent="1">
          <mxGeometry x="530" y="680" width="360" height="50" as="geometry" />
        </mxCell>

      </root>
    </mxGraphModel>
  </diagram>
</mxfile>
